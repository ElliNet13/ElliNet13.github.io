<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EEEEEEEEEE</title>
  <style>
    body {
      font-family: monospace;
      font-size: 48px;
      white-space: pre-wrap;
      margin: 0;
    }
    #sentinel {
      height: 100px; /* Easier to detect near-end */
    }
  </style>
</head>
<body>

<div id="content">
  E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E
</div>

<div id="sentinel"></div>

<script>
  const content = document.getElementById('content');
  const sentinel = document.getElementById('sentinel');

  function addEs(times = 5) {
    const chunk = ' E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E E';
    for (let i = 0; i < times; i++) {
      content.textContent += chunk;
    }
  }

  // Fill the page at the start
  addEs(20);

  function checkScroll() {
    const sentinelRect = sentinel.getBoundingClientRect();
    const viewportHeight = window.innerHeight || document.documentElement.clientHeight;

    // If sentinel is within 300px of the bottom, add more Es
    if (sentinelRect.top < viewportHeight + 300) {
      addEs(5);
    }

    requestAnimationFrame(checkScroll); // Keep looping
  }

  // Start checking forever
  requestAnimationFrame(checkScroll);
</script>

</body>
</html>
